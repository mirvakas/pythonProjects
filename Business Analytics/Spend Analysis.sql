/*SQL Queries for BI*/SELECT count(distinct COMP_ID) as "B" FROM SCHEMA.ACCOUNTSPAYABLE_HDR WHERE SUB_ID=@CUSTOMERID and GEN_DATE between TO_DATE('2021-01-01', 'YYYY-MM-DD') and TO_DATE('2022-12-01', 'YYYY-MM-DD')  and nvl(is_deleted,0)!='1' and COMP_ID not in (SELECT COMP_ID FROM SCHEMA.COMP_PRFLE WHERE SUB_ID=@CUSTOMERID and is_buyer=1 and active=1 and SPENDING_BUYER_ATTR is null)
SELECT COUNT(distinct PC) as "X1" from  (SELECT b.ATTR1 as PC FROM SCHEMA.ACCOUNTSPAYABLE_HDR a,SCHEMA.COMP_PRFLE b WHERE a.SUB_ID=@CUSTOMERID and a.GEN_DATE between TO_DATE('2021-01-01', 'YYYY-MM-DD') and TO_DATE('2022-12-01', 'YYYY-MM-DD')  and nvl(a.is_deleted,0)!='1' and a.COMP_ID  in (SELECT COMP_ID FROM SCHEMA.COMP_PRFLE WHERE SUB_ID=@CUSTOMERID and is_buyer=1 and active=1 and SPENDING_BUYER_ATTR is not null) and a.SUB_ID=b.SUB_ID and a.COMP_ID=b.COMP_ID  and b.is_buyer=1 and b.SPENDING_BUYER_ATTR is not null UNION SELECT b.ATTR1 FROM SCHEMA.PO_HEADER a,SCHEMA.COMP_PRFLE b WHERE a.SUB_ID=@CUSTOMERID and a.GEN_DATE between TO_DATE('2021-01-01', 'YYYY-MM-DD') and TO_DATE('2022-12-01', 'YYYY-MM-DD')  and nvl(a.is_deleted,0)!='1' and a.COMP_ID in (SELECT COMP_ID FROM SCHEMA.COMP_PRFLE WHERE SUB_ID=@CUSTOMERID and is_buyer=1 and active=1 and ATTR is not null) and a.SUB_ID=b.SUB_ID and a.COMP_ID=b.COMP_ID  and b.is_buyer=1)
SELECT count(1) as "C" FROM SCHEMA.APADJ_MEMO_HEADER  WHERE SUB_ID=@CUSTOMERID and GEN_DATE between TO_DATE('2021-01-01', 'YYYY-MM-DD') and TO_DATE('2022-12-01', 'YYYY-MM-DD')  and COMP_ID not in (SELECT COMP_ID FROM SCHEMA.COMP_PRFLE WHERE SUB_ID=@CUSTOMERID and is_buyer=1 and active=1 and SPENDING_BUYER_ATTR is null) and   nvl(is_deleted,0)!='1'
SELECT count(1) as "D" FROM SCHEMA.PO_HEADER a,SCHEMA.COMP_PRFLE b WHERE a.SUB_ID=@CUSTOMERID and a.GEN_DATE between TO_DATE('2021-01-01', 'YYYY-MM-DD') and TO_DATE('2022-12-01', 'YYYY-MM-DD')  and nvl(a.is_deleted,0)!='1' and a.COMP_ID not in (SELECT COMP_ID FROM SCHEMA.COMP_PRFLE WHERE SUB_ID=@CUSTOMERID and is_buyer=1 and active=1 and SPENDING_BUYER_ATTR is null) and a.SUB_ID=b.SUB_ID and a.supplier_COMP_ID=b.COMP_ID  and a.SUPPLIER_COMP_ID<>a.COMP_ID 
SELECT count(1) as "E" FROM SCHEMA.ACCOUNTSPAYABLE_HDR a, SCHEMA.COMP_PRFLE b WHERE a.SUB_ID = @CUSTOMERID  and a.SUB_ID = b.SUB_ID  and a.supplier_COMP_ID = b.COMP_ID  and a.GEN_DATE between TO_DATE('2021-01-01', 'YYYY-MM-DD') and TO_DATE('2022-12-01', 'YYYY-MM-DD')  and a.COMP_ID in (SELECT COMP_ID  FROM SCHEMA.COMP_PRFLE WHERE SUB_ID = @CUSTOMERID and is_buyer = 1 and active = 1 and SPENDING_BUYER_ATTR is not null)  and nvl(a.is_deleted, 0) != '1'
SELECT count(1) as "F" FROM SCHEMA.PPO_MASTER_DETAIL WHERE SUB_ID=@CUSTOMERID and GEN_DATE between TO_DATE('2021-01-01', 'YYYY-MM-DD') and TO_DATE('2022-12-01', 'YYYY-MM-DD')  and PO_ID in (SELECT a.PO_ID FROM SCHEMA.PO_HEADER a,SCHEMA.COMP_PRFLE b WHERE a.SUB_ID=@CUSTOMERID and a.GEN_DATE between TO_DATE('2021-01-01', 'YYYY-MM-DD') and TO_DATE('2022-12-01', 'YYYY-MM-DD')  and nvl(a.is_deleted,0)!='1' and a.SUB_ID=b.SUB_ID and a.COMP_ID=b.COMP_ID and B.IS_BUYER=1 and b.active=1 and SPENDING_BUYER_ATTR is not null)
SELECT count(1) as "G" FROM SCHEMA.APINVOICE_DETAIL WHERE SUB_ID=@CUSTOMERID and GEN_DATE between TO_DATE('2021-01-01', 'YYYY-MM-DD') and TO_DATE('2022-12-01', 'YYYY-MM-DD')  and (COMP_ID,AP_ID) in (SELECT COMP_ID,AP_ID FROM SCHEMA.ACCOUNTSPAYABLE_HDR WHERE SUB_ID=@CUSTOMERID and GEN_DATE between TO_DATE('2021-01-01', 'YYYY-MM-DD') and TO_DATE('2022-12-01', 'YYYY-MM-DD')  and COMP_ID not in (SELECT COMP_ID FROM SCHEMA.COMP_PRFLE WHERE SUB_ID=@CUSTOMERID and is_buyer=1 and active=1 and SPENDING_BUYER_ATTR is null) and nvl(is_deleted,0)!='1')
SELECT sum(TOTAL_TRX_AMT) as "H" FROM SCHEMA.PO_HEADER a,SCHEMA.COMP_PRFLE b WHERE a.SUB_ID=@CUSTOMERID and a.GEN_DATE between TO_DATE('2021-01-01', 'YYYY-MM-DD') and TO_DATE('2022-12-01', 'YYYY-MM-DD')  and nvl(a.is_deleted,0)!='1' and a.COMP_ID not in (SELECT COMP_ID FROM SCHEMA.COMP_PRFLE WHERE SUB_ID=@CUSTOMERID and is_buyer=1 and active=1 and SPENDING_BUYER_ATTR is null) and a.SUB_ID=b.SUB_ID and a.supplier_COMP_ID=b.COMP_ID  and a.SUPPLIER_COMP_ID<>a.COMP_ID 
SELECT max(TOTAL_TRX_AMT) as "I" FROM SCHEMA.PO_HEADER WHERE SUB_ID=@CUSTOMERID and GEN_DATE between TO_DATE('2021-01-01', 'YYYY-MM-DD') and TO_DATE('2022-12-01', 'YYYY-MM-DD')  and nvl(is_deleted,0)!='1' and COMP_ID not in (SELECT COMP_ID FROM SCHEMA.COMP_PRFLE WHERE SUB_ID=@CUSTOMERID and is_buyer=1 and active=1 and SPENDING_BUYER_ATTR is null)
SELECT sum(TOTAL_TRX_AMT) as "J" FROM SCHEMA.ACCOUNTSPAYABLE_HDR WHERE SUB_ID=@CUSTOMERID and GEN_DATE between TO_DATE('2021-01-01', 'YYYY-MM-DD') and TO_DATE('2022-12-01', 'YYYY-MM-DD')  and COMP_ID not in (SELECT COMP_ID FROM SCHEMA.COMP_PRFLE WHERE SUB_ID=@CUSTOMERID and is_buyer=1 and active=1 and SPENDING_BUYER_ATTR is null) and nvl(is_deleted,0)!='1'
SELECT max(TOTAL_TRX_AMT) as "K" FROM SCHEMA.ACCOUNTSPAYABLE_HDR WHERE SUB_ID=@CUSTOMERID and GEN_DATE between TO_DATE('2021-01-01', 'YYYY-MM-DD') and TO_DATE('2022-12-01', 'YYYY-MM-DD')  and COMP_ID not in (SELECT COMP_ID FROM SCHEMA.COMP_PRFLE WHERE SUB_ID=@CUSTOMERID and is_buyer=1 and active=1 and SPENDING_BUYER_ATTR is null) and nvl(is_deleted,0)!='1'
SELECT max(TOTAL_LINE_TRX_AMT) as "L" FROM SCHEMA.PPO_MASTER_DETAIL WHERE SUB_ID=@CUSTOMERID and (COMP_ID,PO_ID) in (SELECT COMP_ID,PO_ID FROM SCHEMA.PO_HEADER WHERE SUB_ID=@CUSTOMERID and GEN_DATE between TO_DATE('2021-01-01', 'YYYY-MM-DD') and TO_DATE('2022-12-01', 'YYYY-MM-DD')  and nvl(is_deleted,0)!='1' and COMP_ID in (SELECT COMP_ID FROM SCHEMA.COMP_PRFLE WHERE SUB_ID=@CUSTOMERID and is_buyer=1 and active=1 and SPENDING_BUYER_ATTR is not null))
SELECT max(TOTAL_LINE_TRX_AMT) as "M" FROM SCHEMA.APINVOICE_DETAIL WHERE SUB_ID = @CUSTOMERID and (COMP_ID,AP_ID) in (SELECT COMP_ID,AP_ID FROM SCHEMA.ACCOUNTSPAYABLE_HDR WHERE SUB_ID = @CUSTOMERID and GEN_DATE >= TO_DATE('2021-01-01', 'YYYY-MM-DD')and COMP_ID in (SELECT COMP_ID FROM SCHEMA.COMP_PRFLE WHERE SUB_ID = @CUSTOMERID and is_buyer = 1 and active = 1 and SPENDING_BUYER_ATTR is not null) and nvl(is_deleted, 0) != '1')
SELECT count(1) as "N" FROM SCHEMA.pcat_catalog_item where SUB_ID=@CUSTOMERID and nvl(DEACTIVATED,0)<>1 and EXPIRATION_DATE is  null
SELECT min(TOTAL_TRX_AMT) as "O" FROM SCHEMA.PO_HEADER WHERE SUB_ID=@CUSTOMERID and GEN_DATE between TO_DATE('2021-01-01', 'YYYY-MM-DD') and TO_DATE('2022-12-01', 'YYYY-MM-DD')  and nvl(is_deleted,0)!='1' and COMP_ID in (SELECT COMP_ID FROM SCHEMA.COMP_PRFLE WHERE SUB_ID=@CUSTOMERID and is_buyer=1 and active=1 and SPENDING_BUYER_ATTR is not null) and TOTAL_TRX_AMT>0
SELECT trunc(a.GEN_DATE) as "Date",count(1)  as "P"   FROM SCHEMA.PO_HEADER a,SCHEMA.COMP_PRFLE b WHERE a.SUB_ID=@CUSTOMERID and a.GEN_DATE>sysdate-11 and nvl(a.is_deleted,0)!='1' and a.COMP_ID in (SELECT COMP_ID FROM SCHEMA.COMP_PRFLE WHERE SUB_ID=@CUSTOMERID and is_buyer=1 and active=1 and SPENDING_BUYER_ATTR is not null) and a.SUB_ID=b.SUB_ID and a.supplier_COMP_ID=b.COMP_ID  and a.SUPPLIER_COMP_ID<>a.COMP_ID group by trunc(a.GEN_DATE) order by 1 asc
SELECT trunc(a.GEN_DATE) as "Date" ,sum(a.TOTAL_TRX_AMT)  as "Q"   FROM SCHEMA.PO_HEADER a,SCHEMA.COMP_PRFLE b WHERE a.SUB_ID=@CUSTOMERID and a.GEN_DATE>sysdate-10 and nvl(a.is_deleted,0)!='1' and a.COMP_ID  in (SELECT COMP_ID FROM SCHEMA.COMP_PRFLE WHERE SUB_ID=@CUSTOMERID and is_buyer=1 and active=1 and SPENDING_BUYER_ATTR is not null) and a.SUB_ID=b.SUB_ID and a.supplier_COMP_ID=b.COMP_ID  and a.SUPPLIER_COMP_ID<>a.COMP_ID group by trunc(a.GEN_DATE) order by 1 asc
SELECT trunc(GEN_DATE) as "Date",count(1)  as "R" FROM SCHEMA.ACCOUNTSPAYABLE_HDR WHERE SUB_ID=@CUSTOMERID and GEN_DATE>sysdate-10 and nvl(is_deleted,0)!='1' and COMP_ID in (SELECT COMP_ID FROM SCHEMA.COMP_PRFLE WHERE SUB_ID=@CUSTOMERID and is_buyer=1 and active=1 and SPENDING_BUYER_ATTR is not null) group by trunc(GEN_DATE) order by 1 asc
SELECT trunc(GEN_DATE) as "Date",sum(TOTAL_TRX_AMT)  as "S"  FROM SCHEMA.ACCOUNTSPAYABLE_HDR WHERE SUB_ID=@CUSTOMERID and GEN_DATE>sysdate-10 and nvl(is_deleted,0)!='1' and COMP_ID in (SELECT COMP_ID FROM SCHEMA.COMP_PRFLE WHERE SUB_ID=@CUSTOMERID and is_buyer=1 and active=1 and SPENDING_BUYER_ATTR is not null) group by trunc(GEN_DATE) order by 1 asc
SELECT count(1)  as "T"  FROM SCHEMA.SM_REPORT_LOG WHERE SUB_ID=@CUSTOMERID and GEN_DATE between TO_DATE('2021-01-01', 'YYYY-MM-DD') and TO_DATE('2022-12-01', 'YYYY-MM-DD') 
SELECT b.COMP_NAME as "Supplier", count(1) as "U"  FROM SCHEMA.PO_HEADER a,SCHEMA.COMP_PRFLE b WHERE a.SUB_ID=@CUSTOMERID and a.GEN_DATE>=sysdate-15 and nvl(a.is_deleted,0)!='1' and a.COMP_ID in (SELECT COMP_ID FROM SCHEMA.COMP_PRFLE WHERE SUB_ID=@CUSTOMERID and is_buyer=1 and active=1 and SPENDING_BUYER_ATTR is not null) and a.SUB_ID=b.SUB_ID and a.supplier_COMP_ID=b.COMP_ID  and a.SUPPLIER_COMP_ID<>a.COMP_ID group by a.SUPPLIER_COMP_ID,b.COMP_NAME order by 2 desc
SELECT b.COMP_NAME as "Supplier", count(1) as "V" FROM SCHEMA.PO_HEADER a,SCHEMA.COMP_PRFLE b WHERE a.SUB_ID=@CUSTOMERID and a.GEN_DATE between TO_DATE('2021-01-01', 'YYYY-MM-DD') and TO_DATE('2022-12-01', 'YYYY-MM-DD')  and nvl(a.is_deleted,0)!='1' and a.COMP_ID in (SELECT COMP_ID FROM SCHEMA.COMP_PRFLE WHERE SUB_ID=@CUSTOMERID and is_buyer=1 and active=1 and SPENDING_BUYER_ATTR is not null) and a.SUB_ID=b.SUB_ID and a.supplier_COMP_ID=b.COMP_ID  and a.SUPPLIER_COMP_ID<>a.COMP_ID group by a.SUPPLIER_COMP_ID,b.COMP_NAME order by 2 desc
SELECT count(1) as "W" FROM SCHEMA.COMP_PRFLE WHERE SUB_ID=@CUSTOMERID and is_buyer='1' and active='1'
SELECT COUNT(distinct PC) as "X1" from  (SELECT b.ATTR1 as PC FROM SCHEMA.ACCOUNTSPAYABLE_HDR a,SCHEMA.COMP_PRFLE b WHERE a.SUB_ID=@CUSTOMERID and a.GEN_DATE between TO_DATE('2021-01-01', 'YYYY-MM-DD') and TO_DATE('2022-12-01', 'YYYY-MM-DD')  and nvl(a.is_deleted,0)!='1' and a.COMP_ID  in (SELECT COMP_ID FROM SCHEMA.COMP_PRFLE WHERE SUB_ID=@CUSTOMERID and is_buyer=1 and active=1 and SPENDING_BUYER_ATTR is not null) and a.SUB_ID=b.SUB_ID and a.COMP_ID=b.COMP_ID  and b.is_buyer=1 and b.SPENDING_BUYER_ATTR is not null UNION SELECT b.ATTR1 FROM SCHEMA.PO_HEADER a,SCHEMA.COMP_PRFLE b WHERE a.SUB_ID=@CUSTOMERID and a.GEN_DATE between TO_DATE('2021-01-01', 'YYYY-MM-DD') and TO_DATE('2022-12-01', 'YYYY-MM-DD')  and nvl(a.is_deleted,0)!='1' and a.COMP_ID in (SELECT COMP_ID FROM SCHEMA.COMP_PRFLE WHERE SUB_ID=@CUSTOMERID and is_buyer=1 and active=1 and ATTR is not null) and a.SUB_ID=b.SUB_ID and a.COMP_ID=b.COMP_ID  and b.is_buyer=1)
SELECT count(1)  as "X" FROM SCHEMA.ACCOUNTSPAYABLE_HDR a, SCHEMA.COMP_PRFLE b WHERE a.SUB_ID = @CUSTOMERID  and a.SUB_ID = b.SUB_ID  and a.supplier_COMP_ID = b.COMP_ID  and a.REFERENCE_PO is null  and a.GEN_DATE between TO_DATE('2021-01-01', 'YYYY-MM-DD') and TO_DATE('2022-12-01', 'YYYY-MM-DD')  and a.COMP_ID in (SELECT COMP_ID           FROM SCHEMA.COMP_PRFLE          WHERE SUB_ID = @CUSTOMERID and is_buyer = 1 and active = 1 and SPENDING_BUYER_ATTR is not null)  and nvl(a.is_deleted, 0) != '1'
SELECT   COUNT(1) as "XA" FROM (SELECT a.AP_ID,a.SUPPLIER_COMP_ID,a.VENDOR_CODE,b.COMP_NAME FROM SCHEMA.ACCOUNTSPAYABLE_HDR a, SCHEMA.COMP_PRFLE b WHERE a.SUB_ID = @CUSTOMERID  and a.SUB_ID = b.SUB_ID  and a.supplier_COMP_ID = b.COMP_ID  and a.GEN_DATE between TO_DATE('2021-01-01', 'YYYY-MM-DD') and TO_DATE('2022-12-01', 'YYYY-MM-DD')  and a.COMP_ID in(SELECT COMP_ID   FROM SCHEMA.COMP_PRFLE  WHERE SUB_ID = @CUSTOMERID    and is_buyer = 1    and active = 1    and SPENDING_BUYER_ATTR is not null)  and nvl(a.is_deleted, 0) != '1'  and a.REFERENCE_PO is null minus SELECT a.AP_ID,a.SUPPLIER_COMP_ID,a.VENDOR_CODE,b.COMP_NAME FROM SCHEMA.ACCOUNTSPAYABLE_HDR a, SCHEMA.COMP_PRFLE b WHERE a.SUB_ID = @CUSTOMERID    and nvl(b.uses_supplier_portal_for,0) not in (2,3)  and a.SUB_ID = b.SUB_ID  and a.supplier_COMP_ID = b.COMP_ID  and a.REFERENCE_PO is null  and nvl(a.is_deleted, 0) != '1'  and a.COMP_ID in (SELECT COMP_ID           FROM SCHEMA.COMP_PRFLE          WHERE SUB_ID = @CUSTOMERID and is_buyer = 1 and active = 1 and SPENDING_BUYER_ATTR is not null)  and a.GEN_DATE between TO_DATE('2021-01-01', 'YYYY-MM-DD') and TO_DATE('2022-12-01', 'YYYY-MM-DD')  and exists (SELECT 1 FROM SCHEMA.SUPPLIER_APP_INVOICE_HEADER c WHERE c.SUB_ID = @CUSTOMERID  and nvl(c.is_deleted, 0) != '1'  and a.SUB_ID = c.SUB_ID  and a.AP_ID = c.AP_ID) and not exists (SELECT 1   FROM SCHEMA.EDI_EXCHANGE_INVOICES d  WHERE d.SUB_ID = @CUSTOMERID    and a.SUB_ID = d.SUB_ID    and a.AP_ID = d.AP_ID) minus SELECT a.AP_ID,a.SUPPLIER_COMP_ID,a.VENDOR_CODE,b.COMP_NAME FROM SCHEMA.ACCOUNTSPAYABLE_HDR a, SCHEMA.COMP_PRFLE b WHERE a.SUB_ID = @CUSTOMERID  and a.SUB_ID = b.SUB_ID  and a.supplier_COMP_ID = b.COMP_ID  and a.REFERENCE_PO is null and a.GEN_DATE between  TO_DATE('2021-01-01', 'YYYY-MM-DD') and TO_DATE('2022-12-01', 'YYYY-MM-DD') and a.COMP_ID in (SELECT COMP_ID FROM SCHEMA.COMP_PRFLE WHERE SUB_ID = @CUSTOMERID   and is_buyer = 1 and active = 1 and SPENDING_BUYER_ATTR is not null)  and nvl(a.is_deleted, 0) != '1' and exists (SELECT 1 FROM SCHEMA.EDI_EXCHANGE_INVOICES c WHERE c.SUB_ID = @CUSTOMERID  and a.SUB_ID = c.SUB_ID  and a.AP_ID = c.AP_ID  and (c.creation_user in (select FTP_FOR from SCHEMA.FTP_UPLOAD_SETUP where SUB_ID=@CUSTOMERID and ftp_upload_dir like '%.CSV Invoices%'))) minus SELECT a.AP_ID,a.SUPPLIER_COMP_ID,a.VENDOR_CODE,b.COMP_NAME FROM SCHEMA.ACCOUNTSPAYABLE_HDR a, SCHEMA.COMP_PRFLE b WHERE a.SUB_ID = @CUSTOMERID  and a.SUB_ID = b.SUB_ID  and a.supplier_COMP_ID = b.COMP_ID  and a.REFERENCE_PO is null  and a.GEN_DATE between TO_DATE('2021-01-01', 'YYYY-MM-DD') and TO_DATE('2022-12-01', 'YYYY-MM-DD')  and a.COMP_ID in(SELECT COMP_ID   FROM SCHEMA.COMP_PRFLE  WHERE SUB_ID = @CUSTOMERID    and is_buyer = 1    and active = 1    and SPENDING_BUYER_ATTR is not null)  and nvl(a.is_deleted, 0) != '1'  and not exists (SELECT 1   FROM SCHEMA.SUPPLIER_APP_INVOICE_HEADER c  WHERE c.SUB_ID = @CUSTOMERID    and a.SUB_ID = c.SUB_ID    and a.AP_ID = c.AP_ID)  and not exists (SELECT 1   FROM SCHEMA.EDI_EXCHANGE_INVOICES d  WHERE d.SUB_ID = @CUSTOMERID    and a.SUB_ID = d.SUB_ID    and a.AP_ID = d.AP_ID))
SELECT COUNT(1)  as "Y" FROM SCHEMA.ACCOUNTSPAYABLE_HDR a, SCHEMA.COMP_PRFLE b WHERE a.SUB_ID = @CUSTOMERID  and nvl(b.uses_supplier_portal_for,0) not in (2,3) and a.SUB_ID = b.SUB_ID  and a.supplier_COMP_ID = b.COMP_ID  and a.REFERENCE_PO is null  and nvl(a.is_deleted, 0) != '1'  and a.COMP_ID in (SELECT COMP_ID           FROM SCHEMA.COMP_PRFLE          WHERE SUB_ID = @CUSTOMERID and is_buyer = 1 and active = 1 and SPENDING_BUYER_ATTR is not null)  and a.GEN_DATE between TO_DATE('2021-01-01', 'YYYY-MM-DD') and TO_DATE('2022-12-01', 'YYYY-MM-DD')  and exists (SELECT 1 FROM SCHEMA.SUPPLIER_APP_INVOICE_HEADER c WHERE c.SUB_ID = @CUSTOMERID  and nvl(c.is_deleted, 0) != '1'  and a.SUB_ID = c.SUB_ID  and a.AP_ID = c.AP_ID) and not exists (SELECT 1   FROM SCHEMA.EDI_EXCHANGE_INVOICES d  WHERE d.SUB_ID = @CUSTOMERID    and a.SUB_ID = d.SUB_ID    and a.AP_ID = d.AP_ID)
SELECT  count(1) as "Z" FROM SCHEMA.ACCOUNTSPAYABLE_HDR a, SCHEMA.COMP_PRFLE b WHERE a.SUB_ID = @CUSTOMERID  and a.SUB_ID = b.SUB_ID  and a.supplier_COMP_ID = b.COMP_ID  and a.REFERENCE_PO is null and a.GEN_DATE between  TO_DATE('2021-01-01', 'YYYY-MM-DD') and TO_DATE('2022-12-01', 'YYYY-MM-DD') and a.COMP_ID in (SELECT COMP_ID FROM SCHEMA.COMP_PRFLE WHERE SUB_ID = @CUSTOMERID   and is_buyer = 1 and active = 1 and SPENDING_BUYER_ATTR is not null)  and nvl(a.is_deleted, 0) != '1' and exists (SELECT 1 FROM SCHEMA.EDI_EXCHANGE_INVOICES c WHERE c.SUB_ID = @CUSTOMERID  and a.SUB_ID = c.SUB_ID  and a.AP_ID = c.AP_ID  and (c.creation_user in (select FTP_FOR from SCHEMA.FTP_UPLOAD_SETUP where SUB_ID=@CUSTOMERID and ftp_upload_dir like '%.CSV Invoices%')))
SELECT count(1) as "AB"  FROM SCHEMA.ACCOUNTSPAYABLE_HDR a, SCHEMA.COMP_PRFLE b WHERE a.SUB_ID = @CUSTOMERID  and a.SUB_ID = b.SUB_ID  and a.supplier_COMP_ID = b.COMP_ID  and a.REFERENCE_PO is null  and a.GEN_DATE between TO_DATE('2021-01-01', 'YYYY-MM-DD') and TO_DATE('2022-12-01', 'YYYY-MM-DD')  and a.COMP_ID in (SELECT COMP_ID           FROM SCHEMA.COMP_PRFLE          WHERE SUB_ID = @CUSTOMERID and is_buyer = 1 and active = 1 and SPENDING_BUYER_ATTR is not null)  and nvl(a.is_deleted, 0) != '1'  and not exists (SELECT 1 FROM SCHEMA.SUPPLIER_APP_INVOICE_HEADER c WHERE c.SUB_ID = @CUSTOMERID  and a.SUB_ID = c.SUB_ID  and a.AP_ID = c.AP_ID)  and not exists (SELECT 1 FROM SCHEMA.EDI_EXCHANGE_INVOICES d WHERE d.SUB_ID = @CUSTOMERID  and a.SUB_ID = d.SUB_ID  and a.AP_ID = d.AP_ID)
SELECT count(1)  as "AC" FROM SCHEMA.ACCOUNTSPAYABLE_HDR a, SCHEMA.COMP_PRFLE b WHERE a.SUB_ID = @CUSTOMERID  and a.SUB_ID = b.SUB_ID  and a.supplier_COMP_ID = b.COMP_ID  and a.REFERENCE_PO is not null  and a.GEN_DATE between TO_DATE('2021-01-01', 'YYYY-MM-DD') and TO_DATE('2022-12-01', 'YYYY-MM-DD')  and a.COMP_ID in (SELECT COMP_ID           FROM SCHEMA.COMP_PRFLE          WHERE SUB_ID = @CUSTOMERID and is_buyer = 1 and active = 1 and SPENDING_BUYER_ATTR is not null)  and nvl(a.is_deleted, 0) != '1'
SELECT  COUNT(1) as "AC1" FROM (SELECT a.AP_ID,a.SUPPLIER_COMP_ID,a.VENDOR_CODE,b.COMP_NAME FROM SCHEMA.ACCOUNTSPAYABLE_HDR a, SCHEMA.COMP_PRFLE b WHERE a.SUB_ID = @CUSTOMERID  and a.SUB_ID = b.SUB_ID  and a.supplier_COMP_ID = b.COMP_ID  and a.GEN_DATE between TO_DATE('2021-01-01', 'YYYY-MM-DD') and TO_DATE('2022-12-01', 'YYYY-MM-DD')  and a.COMP_ID in(SELECT COMP_ID   FROM SCHEMA.COMP_PRFLE  WHERE SUB_ID = @CUSTOMERID    and is_buyer = 1    and active = 1    and SPENDING_BUYER_ATTR is not null)  and nvl(a.is_deleted, 0) != '1'  and a.REFERENCE_PO is not null minus SELECT a.AP_ID,a.SUPPLIER_COMP_ID,a.VENDOR_CODE,b.COMP_NAME FROM SCHEMA.ACCOUNTSPAYABLE_HDR a, SCHEMA.COMP_PRFLE b WHERE a.SUB_ID = @CUSTOMERID  and nvl(b.uses_supplier_portal_for,0) not in (2,3) and a.SUB_ID = b.SUB_ID  and a.supplier_COMP_ID = b.COMP_ID  and a.REFERENCE_PO is not null  and nvl(a.is_deleted, 0) != '1'  and a.COMP_ID in (SELECT COMP_ID           FROM SCHEMA.COMP_PRFLE          WHERE SUB_ID = @CUSTOMERID and is_buyer = 1 and active = 1 and SPENDING_BUYER_ATTR is not null)  and a.GEN_DATE between TO_DATE('2021-01-01', 'YYYY-MM-DD') and TO_DATE('2022-12-01', 'YYYY-MM-DD')  and exists (SELECT 1 FROM SCHEMA.SUPPLIER_APP_INVOICE_HEADER c WHERE c.SUB_ID = @CUSTOMERID  and nvl(c.is_deleted, 0) != '1'  and a.SUB_ID = c.SUB_ID  and a.AP_ID = c.AP_ID) and not exists (SELECT 1   FROM SCHEMA.EDI_EXCHANGE_INVOICES d  WHERE d.SUB_ID = @CUSTOMERID    and a.SUB_ID = d.SUB_ID    and a.AP_ID = d.AP_ID) minus SELECT a.AP_ID,a.SUPPLIER_COMP_ID,a.VENDOR_CODE,b.COMP_NAME FROM SCHEMA.ACCOUNTSPAYABLE_HDR a, SCHEMA.COMP_PRFLE b WHERE a.SUB_ID = @CUSTOMERID  and a.SUB_ID = b.SUB_ID  and a.supplier_COMP_ID = b.COMP_ID  and a.REFERENCE_PO is not null and a.GEN_DATE between  TO_DATE('2021-01-01', 'YYYY-MM-DD') and TO_DATE('2022-12-01', 'YYYY-MM-DD') and a.COMP_ID in (SELECT COMP_ID FROM SCHEMA.COMP_PRFLE WHERE SUB_ID = @CUSTOMERID   and is_buyer = 1 and active = 1 and SPENDING_BUYER_ATTR is not null)  and nvl(a.is_deleted, 0) != '1' and exists (SELECT 1 FROM SCHEMA.EDI_EXCHANGE_INVOICES c WHERE c.SUB_ID = @CUSTOMERID  and a.SUB_ID = c.SUB_ID  and a.AP_ID = c.AP_ID  and (c.creation_user in (select FTP_FOR from SCHEMA.FTP_UPLOAD_SETUP where SUB_ID=@CUSTOMERID and ftp_upload_dir like '%.CSV Invoices%'))) minus SELECT a.AP_ID,a.SUPPLIER_COMP_ID,a.VENDOR_CODE,b.COMP_NAME FROM SCHEMA.ACCOUNTSPAYABLE_HDR a, SCHEMA.COMP_PRFLE b WHERE a.SUB_ID = @CUSTOMERID  and a.SUB_ID = b.SUB_ID  and a.supplier_COMP_ID = b.COMP_ID  and a.REFERENCE_PO is not null  and a.GEN_DATE between TO_DATE('2021-01-01', 'YYYY-MM-DD') and TO_DATE('2022-12-01', 'YYYY-MM-DD')  and a.COMP_ID in(SELECT COMP_ID   FROM SCHEMA.COMP_PRFLE  WHERE SUB_ID = @CUSTOMERID    and is_buyer = 1    and active = 1    and SPENDING_BUYER_ATTR is not null)  and nvl(a.is_deleted, 0) != '1'  and not exists (SELECT 1   FROM SCHEMA.SUPPLIER_APP_INVOICE_HEADER c  WHERE c.SUB_ID = @CUSTOMERID    and a.SUB_ID = c.SUB_ID    and a.AP_ID = c.AP_ID)  and not exists (SELECT 1   FROM SCHEMA.EDI_EXCHANGE_INVOICES d  WHERE d.SUB_ID = @CUSTOMERID    and a.SUB_ID = d.SUB_ID    and a.AP_ID = d.AP_ID))
SELECT COUNT(1)  as "AD" FROM SCHEMA.ACCOUNTSPAYABLE_HDR a, SCHEMA.COMP_PRFLE b WHERE a.SUB_ID = @CUSTOMERID  and nvl(b.uses_supplier_portal_for,0) not in (2,3) and a.SUB_ID = b.SUB_ID  and a.supplier_COMP_ID = b.COMP_ID  and a.REFERENCE_PO is not null  and nvl(a.is_deleted, 0) != '1'  and a.COMP_ID in (SELECT COMP_ID           FROM SCHEMA.COMP_PRFLE          WHERE SUB_ID = @CUSTOMERID and is_buyer = 1 and active = 1 and SPENDING_BUYER_ATTR is not null)  and a.GEN_DATE between TO_DATE('2021-01-01', 'YYYY-MM-DD') and TO_DATE('2022-12-01', 'YYYY-MM-DD')  and exists (SELECT 1 FROM SCHEMA.SUPPLIER_APP_INVOICE_HEADER c WHERE c.SUB_ID = @CUSTOMERID  and nvl(c.is_deleted, 0) != '1'  and a.SUB_ID = c.SUB_ID  and a.AP_ID = c.AP_ID) and not exists (SELECT 1   FROM SCHEMA.EDI_EXCHANGE_INVOICES d  WHERE d.SUB_ID = @CUSTOMERID    and a.SUB_ID = d.SUB_ID    and a.AP_ID = d.AP_ID)
SELECT count(1) as "AE" FROM SCHEMA.ACCOUNTSPAYABLE_HDR a, SCHEMA.COMP_PRFLE b WHERE a.SUB_ID = @CUSTOMERID  and a.SUB_ID = b.SUB_ID  and a.supplier_COMP_ID = b.COMP_ID  and a.REFERENCE_PO is not null and a.GEN_DATE between  TO_DATE('2021-01-01', 'YYYY-MM-DD') and TO_DATE('2022-12-01', 'YYYY-MM-DD') and a.COMP_ID in (SELECT COMP_ID FROM SCHEMA.COMP_PRFLE WHERE SUB_ID = @CUSTOMERID   and is_buyer = 1 and active = 1 and SPENDING_BUYER_ATTR is not null)  and nvl(a.is_deleted, 0) != '1' and exists (SELECT 1 FROM SCHEMA.EDI_EXCHANGE_INVOICES c WHERE c.SUB_ID = @CUSTOMERID  and a.SUB_ID = c.SUB_ID  and a.AP_ID = c.AP_ID  and (c.creation_user in (select FTP_FOR from SCHEMA.FTP_UPLOAD_SETUP where SUB_ID=@CUSTOMERID and ftp_upload_dir like '%.CSV Invoices%')))
SELECT  count(1) as "AF"  FROM SCHEMA.ACCOUNTSPAYABLE_HDR a, SCHEMA.COMP_PRFLE b WHERE a.SUB_ID = @CUSTOMERID  and a.SUB_ID = b.SUB_ID  and a.supplier_COMP_ID = b.COMP_ID  and a.REFERENCE_PO is not null  and a.GEN_DATE between TO_DATE('2021-01-01', 'YYYY-MM-DD') and TO_DATE('2022-12-01', 'YYYY-MM-DD')  and a.COMP_ID in (SELECT COMP_ID           FROM SCHEMA.COMP_PRFLE          WHERE SUB_ID = @CUSTOMERID and is_buyer = 1 and active = 1 and SPENDING_BUYER_ATTR is not null)  and nvl(a.is_deleted, 0) != '1'  and not exists (SELECT 1 FROM SCHEMA.SUPPLIER_APP_INVOICE_HEADER c WHERE c.SUB_ID = @CUSTOMERID  and a.SUB_ID = c.SUB_ID  and a.AP_ID = c.AP_ID)  and not exists (SELECT 1 FROM SCHEMA.EDI_EXCHANGE_INVOICES d WHERE d.SUB_ID = @CUSTOMERID  and a.SUB_ID = d.SUB_ID  and a.AP_ID = d.AP_ID)
SELECT substr(b.ATTR,13,40)  as "AG" ,count(1)  as "Count" FROM SCHEMA.PO_HEADER a,SCHEMA.COMP_PRFLE b WHERE a.SUB_ID=@CUSTOMERID and a.GEN_DATE between TO_DATE('2021-01-01', 'YYYY-MM-DD') and TO_DATE('2022-12-01', 'YYYY-MM-DD')  and nvl(a.is_deleted,0)!='1' and a.COMP_ID in (SELECT COMP_ID FROM SCHEMA.COMP_PRFLE WHERE SUB_ID=@CUSTOMERID and is_buyer=1 and active=1 and SPENDING_BUYER_ATTR is not null) and a.SUB_ID=b.SUB_ID and a.COMP_ID=b.COMP_ID  and b.is_buyer=1 group by b.ATTR ORDER BY 2 desc
SELECT substr(b.ATTR1,13,40) as "AH" ,count(1) as "Count"  FROM SCHEMA.PO_HEADER a,SCHEMA.COMP_PRFLE b WHERE a.SUB_ID=@CUSTOMERID and a.GEN_DATE between TO_DATE('2021-01-01', 'YYYY-MM-DD') and TO_DATE('2022-12-01', 'YYYY-MM-DD')  and nvl(a.is_deleted,0)!='1' and a.COMP_ID in (SELECT COMP_ID FROM SCHEMA.COMP_PRFLE WHERE SUB_ID=@CUSTOMERID and is_buyer=1 and active=1 and ATTR is not null) and a.SUB_ID=b.SUB_ID and a.COMP_ID=b.COMP_ID  and b.is_buyer=1 group by b.ATTR1 order by 2 desc
SELECT b.BRAND_NAME as "AI" ,count(1) as "Count" FROM SCHEMA.PO_HEADER a,SCHEMA.COMP_PRFLE b WHERE a.SUB_ID=@CUSTOMERID and a.GEN_DATE between TO_DATE('2021-01-01', 'YYYY-MM-DD') and TO_DATE('2022-12-01', 'YYYY-MM-DD')  and nvl(a.is_deleted,0)!='1' and a.SUB_ID=b.SUB_ID and a.COMP_ID=b.COMP_ID  and b.is_buyer=1 and b.SPENDING_BUYER_ATTR is not null group by b.BRAND_NAME order by 2 desc
SELECT b.BRAND_NAME as "AJ" ,count(1) as "Count"  FROM SCHEMA.ACCOUNTSPAYABLE_HDR a,SCHEMA.COMP_PRFLE b WHERE a.SUB_ID=@CUSTOMERID and a.GEN_DATE between TO_DATE('2021-01-01', 'YYYY-MM-DD') and TO_DATE('2022-12-01', 'YYYY-MM-DD')  and nvl(a.is_deleted,0)!='1' and a.COMP_ID  in (SELECT COMP_ID FROM SCHEMA.COMP_PRFLE WHERE SUB_ID=@CUSTOMERID and is_buyer=1 and active=1 and SPENDING_BUYER_ATTR is not null) and a.SUB_ID=b.SUB_ID and a.COMP_ID=b.COMP_ID  and b.is_buyer=1 and b.SPENDING_BUYER_ATTR is not null group by b.BRAND_NAME order by 2 desc	
SELECT COUNT(0) as "AK" FROM (SELECT  distinct b.BRAND_NAME FROM SCHEMA.PO_HEADER a,SCHEMA.COMP_PRFLE b WHERE a.SUB_ID=@CUSTOMERID and a.GEN_DATE>=TO_DATE('2021-01-01', 'YYYY-MM-DD') and nvl(a.is_deleted,0)!='1' and a.COMP_ID in (SELECT COMP_ID FROM SCHEMA.COMP_PRFLE WHERE SUB_ID=@CUSTOMERID and is_buyer=1 and active=1 and ATTR is not null) and a.SUB_ID=b.SUB_ID and a.COMP_ID=b.COMP_ID  and b.is_buyer=1  union SELECT  distinct b.BRAND_NAME FROM SCHEMA.ACCOUNTSPAYABLE_HDR a,SCHEMA.COMP_PRFLE b WHERE a.SUB_ID=@CUSTOMERID and a.GEN_DATE>=TO_DATE('2021-01-01', 'YYYY-MM-DD') and nvl(a.is_deleted,0)!='1' and a.COMP_ID  in (SELECT COMP_ID FROM SCHEMA.COMP_PRFLE WHERE SUB_ID=@CUSTOMERID and is_buyer=1 and active=1 and SPENDING_BUYER_ATTR is not null) and a.SUB_ID=b.SUB_ID and a.COMP_ID=b.COMP_ID  and b.is_buyer=1 and b.SPENDING_BUYER_ATTR is not null)
SELECT TO_CHAR( GEN_DATE, 'MON-YY' ) "Exception Month",TO_CHAR( GEN_DATE, 'YYYY-MM' ) "Year", count (distinct AP_ID) "Count" FROM SCHEMA.APINVOICE_CHG_HIST where SUB_ID=@CUSTOMERID and VALUE_AFTER='EXCEPTION' and COMP_ID in (SELECT COMP_ID FROM SCHEMA.COMP_PRFLE where SUB_ID=@CUSTOMERID and is_buyer=1 and SPENDING_BUYER_ATTR is not null) and GEN_DATE >TO_DATE('2021-01-01', 'YYYY-MM-DD') GROUP BY TO_CHAR( GEN_DATE, 'MON-YY' ) ,TO_CHAR( GEN_DATE, 'YYYY-MM' ) order by 2