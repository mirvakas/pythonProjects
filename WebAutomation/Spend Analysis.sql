/*SQL Queries for BI*/SELECT count(distinct company_Id) as "B" FROM PBEACH.APINVOICE_HEADER WHERE SUBSCRIBER_ID=641 and creation_date between TO_DATE('2021-01-01', 'YYYY-MM-DD') and TO_DATE('2022-12-01', 'YYYY-MM-DD')  and nvl(is_deleted,0)!='1' and company_id not in (SELECT COMPANY_ID FROM PBEACH.PSM_COMPANY_PROFILE WHERE SUBSCRIBER_ID=641 and is_buyer=1 and active=1 and BATTR_VAL15 is null)
SELECT COUNT(distinct PC) as "X1" from  (SELECT b.BATTR_VAL12 as PC FROM PBEACH.APINVOICE_HEADER a,pbeach.psm_company_profile b WHERE a.SUBSCRIBER_ID=641 and a.creation_date between TO_DATE('2021-01-01', 'YYYY-MM-DD') and TO_DATE('2022-12-01', 'YYYY-MM-DD')  and nvl(a.is_deleted,0)!='1' and a.company_id  in (SELECT COMPANY_ID FROM PBEACH.PSM_COMPANY_PROFILE WHERE SUBSCRIBER_ID=641 and is_buyer=1 and active=1 and BATTR_VAL15 is not null) and a.subscriber_id=b.subscriber_id and a.company_id=b.company_id  and b.is_buyer=1 and b.BATTR_VAL15 is not null UNION SELECT b.BATTR_VAL12 FROM PBEACH.PPO_MASTER_HEADER a,pbeach.psm_company_profile b WHERE a.SUBSCRIBER_ID=641 and a.creation_date between TO_DATE('2021-01-01', 'YYYY-MM-DD') and TO_DATE('2022-12-01', 'YYYY-MM-DD')  and nvl(a.is_deleted,0)!='1' and a.company_id in (SELECT COMPANY_ID FROM PBEACH.PSM_COMPANY_PROFILE WHERE SUBSCRIBER_ID=641 and is_buyer=1 and active=1 and BATTR_VAL14 is not null) and a.subscriber_id=b.subscriber_id and a.company_id=b.company_id  and b.is_buyer=1)
SELECT count(1) as "C" FROM PBEACH.APADJ_MEMO_HEADER  WHERE SUBSCRIBER_ID=641 and creation_date between TO_DATE('2021-01-01', 'YYYY-MM-DD') and TO_DATE('2022-12-01', 'YYYY-MM-DD')  and company_id not in (SELECT COMPANY_ID FROM PBEACH.PSM_COMPANY_PROFILE WHERE SUBSCRIBER_ID=641 and is_buyer=1 and active=1 and BATTR_VAL15 is null) and   nvl(is_deleted,0)!='1'
SELECT count(1) as "D" FROM PBEACH.PPO_MASTER_HEADER a,PBEACH.psm_company_profile b WHERE a.SUBSCRIBER_ID=641 and a.creation_date between TO_DATE('2021-01-01', 'YYYY-MM-DD') and TO_DATE('2022-12-01', 'YYYY-MM-DD')  and nvl(a.is_deleted,0)!='1' and a.company_id not in (SELECT COMPANY_ID FROM PBEACH.PSM_COMPANY_PROFILE WHERE SUBSCRIBER_ID=641 and is_buyer=1 and active=1 and BATTR_VAL15 is null) and a.subscriber_id=b.subscriber_id and a.supplier_company_id=b.company_id  and a.SUPPLIER_COMPANY_ID<>a.company_id 
SELECT count(1) as "E" FROM PBEACH.APINVOICE_HEADER a, PBEACH.PSM_COMPANY_PROFILE b WHERE a.SUBSCRIBER_ID = 641  and a.SUBSCRIBER_ID = b.subscriber_id  and a.supplier_company_id = b.company_id  and a.creation_date between TO_DATE('2021-01-01', 'YYYY-MM-DD') and TO_DATE('2022-12-01', 'YYYY-MM-DD')  and a.company_id in (SELECT COMPANY_ID  FROM PBEACH.PSM_COMPANY_PROFILE WHERE SUBSCRIBER_ID = 641 and is_buyer = 1 and active = 1 and BATTR_VAL15 is not null)  and nvl(a.is_deleted, 0) != '1'
SELECT count(1) as "F" FROM PBEACH.PPO_MASTER_DETAIL WHERE SUBSCRIBER_ID=641 and creation_date between TO_DATE('2021-01-01', 'YYYY-MM-DD') and TO_DATE('2022-12-01', 'YYYY-MM-DD')  and po_number in (SELECT a.po_number FROM PBEACH.PPO_MASTER_HEADER a,PBEACH.psm_company_profile b WHERE a.SUBSCRIBER_ID=641 and a.creation_date between TO_DATE('2021-01-01', 'YYYY-MM-DD') and TO_DATE('2022-12-01', 'YYYY-MM-DD')  and nvl(a.is_deleted,0)!='1' and a.subscriber_id=b.subscriber_id and a.company_id=b.company_id and B.IS_BUYER=1 and b.active=1 and BATTR_VAL15 is not null)
SELECT count(1) as "G" FROM PBEACH.APINVOICE_DETAIL WHERE SUBSCRIBER_ID=641 and creation_date between TO_DATE('2021-01-01', 'YYYY-MM-DD') and TO_DATE('2022-12-01', 'YYYY-MM-DD')  and (company_id,ap_invoice_number) in (SELECT company_id,ap_invoice_number FROM PBEACH.APINVOICE_HEADER WHERE SUBSCRIBER_ID=641 and creation_date between TO_DATE('2021-01-01', 'YYYY-MM-DD') and TO_DATE('2022-12-01', 'YYYY-MM-DD')  and company_id not in (SELECT COMPANY_ID FROM PBEACH.PSM_COMPANY_PROFILE WHERE SUBSCRIBER_ID=641 and is_buyer=1 and active=1 and BATTR_VAL15 is null) and nvl(is_deleted,0)!='1')
SELECT sum(TOTAL_TRX_AMT) as "H" FROM PBEACH.PPO_MASTER_HEADER a,PBEACH.psm_company_profile b WHERE a.SUBSCRIBER_ID=641 and a.creation_date between TO_DATE('2021-01-01', 'YYYY-MM-DD') and TO_DATE('2022-12-01', 'YYYY-MM-DD')  and nvl(a.is_deleted,0)!='1' and a.company_id not in (SELECT COMPANY_ID FROM PBEACH.PSM_COMPANY_PROFILE WHERE SUBSCRIBER_ID=641 and is_buyer=1 and active=1 and BATTR_VAL15 is null) and a.subscriber_id=b.subscriber_id and a.supplier_company_id=b.company_id  and a.SUPPLIER_COMPANY_ID<>a.company_id 
SELECT max(TOTAL_TRX_AMT) as "I" FROM PBEACH.PPO_MASTER_HEADER WHERE SUBSCRIBER_ID=641 and creation_date between TO_DATE('2021-01-01', 'YYYY-MM-DD') and TO_DATE('2022-12-01', 'YYYY-MM-DD')  and nvl(is_deleted,0)!='1' and company_id not in (SELECT COMPANY_ID FROM PBEACH.PSM_COMPANY_PROFILE WHERE SUBSCRIBER_ID=641 and is_buyer=1 and active=1 and BATTR_VAL15 is null)
SELECT sum(TOTAL_TRX_AMT) as "J" FROM PBEACH.APINVOICE_HEADER WHERE SUBSCRIBER_ID=641 and creation_date between TO_DATE('2021-01-01', 'YYYY-MM-DD') and TO_DATE('2022-12-01', 'YYYY-MM-DD')  and company_id not in (SELECT COMPANY_ID FROM PBEACH.PSM_COMPANY_PROFILE WHERE SUBSCRIBER_ID=641 and is_buyer=1 and active=1 and BATTR_VAL15 is null) and nvl(is_deleted,0)!='1'
SELECT max(TOTAL_TRX_AMT) as "K" FROM PBEACH.APINVOICE_HEADER WHERE SUBSCRIBER_ID=641 and creation_date between TO_DATE('2021-01-01', 'YYYY-MM-DD') and TO_DATE('2022-12-01', 'YYYY-MM-DD')  and company_id not in (SELECT COMPANY_ID FROM PBEACH.PSM_COMPANY_PROFILE WHERE SUBSCRIBER_ID=641 and is_buyer=1 and active=1 and BATTR_VAL15 is null) and nvl(is_deleted,0)!='1'
SELECT max(TOTAL_LINE_TRX_AMT) as "L" FROM PBEACH.PPO_MASTER_DETAIL WHERE SUBSCRIBER_ID=641 and (company_id,po_number) in (SELECT company_id,po_number FROM PBEACH.PPO_MASTER_HEADER WHERE SUBSCRIBER_ID=641 and creation_date between TO_DATE('2021-01-01', 'YYYY-MM-DD') and TO_DATE('2022-12-01', 'YYYY-MM-DD')  and nvl(is_deleted,0)!='1' and company_id in (SELECT COMPANY_ID FROM PBEACH.PSM_COMPANY_PROFILE WHERE SUBSCRIBER_ID=641 and is_buyer=1 and active=1 and BATTR_VAL15 is not null))
SELECT max(TOTAL_LINE_TRX_AMT) as "M" FROM PBEACH.APINVOICE_DETAIL WHERE SUBSCRIBER_ID = 641 and (company_id,ap_invoice_number) in (SELECT company_id,ap_invoice_number FROM PBEACH.APINVOICE_HEADER WHERE SUBSCRIBER_ID = 641 and creation_date >= TO_DATE('2021-01-01', 'YYYY-MM-DD')and company_id in (SELECT COMPANY_ID FROM PBEACH.PSM_COMPANY_PROFILE WHERE SUBSCRIBER_ID = 641 and is_buyer = 1 and active = 1 and BATTR_VAL15 is not null) and nvl(is_deleted, 0) != '1')
SELECT count(1) as "N" FROM PBEACH.pcat_catalog_item where subscriber_id=641 and nvl(DEACTIVATED,0)<>1 and EXPIRATION_DATE is  null
SELECT min(TOTAL_TRX_AMT) as "O" FROM PBEACH.PPO_MASTER_HEADER WHERE SUBSCRIBER_ID=641 and creation_date between TO_DATE('2021-01-01', 'YYYY-MM-DD') and TO_DATE('2022-12-01', 'YYYY-MM-DD')  and nvl(is_deleted,0)!='1' and company_id in (SELECT COMPANY_ID FROM PBEACH.PSM_COMPANY_PROFILE WHERE SUBSCRIBER_ID=641 and is_buyer=1 and active=1 and BATTR_VAL15 is not null) and TOTAL_TRX_AMT>0
SELECT trunc(a.creation_date) as "Date",count(1)  as "P"   FROM PBEACH.PPO_MASTER_HEADER a,PBEACH.psm_company_profile b WHERE a.SUBSCRIBER_ID=641 and a.creation_date>sysdate-11 and nvl(a.is_deleted,0)!='1' and a.company_id in (SELECT COMPANY_ID FROM PBEACH.PSM_COMPANY_PROFILE WHERE SUBSCRIBER_ID=641 and is_buyer=1 and active=1 and BATTR_VAL15 is not null) and a.subscriber_id=b.subscriber_id and a.supplier_company_id=b.company_id  and a.SUPPLIER_COMPANY_ID<>a.company_id group by trunc(a.creation_date) order by 1 asc
SELECT trunc(a.creation_date) as "Date" ,sum(a.TOTAL_TRX_AMT)  as "Q"   FROM PBEACH.PPO_MASTER_HEADER a,PBEACH.psm_company_profile b WHERE a.SUBSCRIBER_ID=641 and a.creation_date>sysdate-10 and nvl(a.is_deleted,0)!='1' and a.company_id  in (SELECT COMPANY_ID FROM PBEACH.PSM_COMPANY_PROFILE WHERE SUBSCRIBER_ID=641 and is_buyer=1 and active=1 and BATTR_VAL15 is not null) and a.subscriber_id=b.subscriber_id and a.supplier_company_id=b.company_id  and a.SUPPLIER_COMPANY_ID<>a.company_id group by trunc(a.creation_date) order by 1 asc
SELECT trunc(creation_date) as "Date",count(1)  as "R" FROM PBEACH.APINVOICE_HEADER WHERE SUBSCRIBER_ID=641 and creation_date>sysdate-10 and nvl(is_deleted,0)!='1' and company_id in (SELECT COMPANY_ID FROM PBEACH.PSM_COMPANY_PROFILE WHERE SUBSCRIBER_ID=641 and is_buyer=1 and active=1 and BATTR_VAL15 is not null) group by trunc(creation_date) order by 1 asc
SELECT trunc(creation_date) as "Date",sum(TOTAL_TRX_AMT)  as "S"  FROM PBEACH.APINVOICE_HEADER WHERE SUBSCRIBER_ID=641 and creation_date>sysdate-10 and nvl(is_deleted,0)!='1' and company_id in (SELECT COMPANY_ID FROM PBEACH.PSM_COMPANY_PROFILE WHERE SUBSCRIBER_ID=641 and is_buyer=1 and active=1 and BATTR_VAL15 is not null) group by trunc(creation_date) order by 1 asc
SELECT count(1)  as "T"  FROM PBEACH.SM_REPORT_LOG WHERE SUBSCRIBER_ID=641 and creation_date between TO_DATE('2021-01-01', 'YYYY-MM-DD') and TO_DATE('2022-12-01', 'YYYY-MM-DD') 
SELECT b.company_name as "Supplier", count(1) as "U"  FROM PBEACH.PPO_MASTER_HEADER a,PBEACH.psm_company_profile b WHERE a.SUBSCRIBER_ID=641 and a.creation_date>=sysdate-15 and nvl(a.is_deleted,0)!='1' and a.company_id in (SELECT COMPANY_ID FROM PBEACH.PSM_COMPANY_PROFILE WHERE SUBSCRIBER_ID=641 and is_buyer=1 and active=1 and BATTR_VAL15 is not null) and a.subscriber_id=b.subscriber_id and a.supplier_company_id=b.company_id  and a.SUPPLIER_COMPANY_ID<>a.company_id group by a.SUPPLIER_COMPANY_ID,b.company_name order by 2 desc
SELECT b.company_name as "Supplier", count(1) as "V" FROM PBEACH.PPO_MASTER_HEADER a,PBEACH.psm_company_profile b WHERE a.SUBSCRIBER_ID=641 and a.creation_date between TO_DATE('2021-01-01', 'YYYY-MM-DD') and TO_DATE('2022-12-01', 'YYYY-MM-DD')  and nvl(a.is_deleted,0)!='1' and a.company_id in (SELECT COMPANY_ID FROM PBEACH.PSM_COMPANY_PROFILE WHERE SUBSCRIBER_ID=641 and is_buyer=1 and active=1 and BATTR_VAL15 is not null) and a.subscriber_id=b.subscriber_id and a.supplier_company_id=b.company_id  and a.SUPPLIER_COMPANY_ID<>a.company_id group by a.SUPPLIER_COMPANY_ID,b.company_name order by 2 desc
SELECT count(1) as "W" FROM PBEACH.PSM_COMPANY_PROFILE WHERE SUBSCRIBER_ID=641 and is_buyer='1' and active='1'
SELECT COUNT(distinct PC) as "X1" from  (SELECT b.BATTR_VAL12 as PC FROM PBEACH.APINVOICE_HEADER a,pbeach.psm_company_profile b WHERE a.SUBSCRIBER_ID=641 and a.creation_date between TO_DATE('2021-01-01', 'YYYY-MM-DD') and TO_DATE('2022-12-01', 'YYYY-MM-DD')  and nvl(a.is_deleted,0)!='1' and a.company_id  in (SELECT COMPANY_ID FROM PBEACH.PSM_COMPANY_PROFILE WHERE SUBSCRIBER_ID=641 and is_buyer=1 and active=1 and BATTR_VAL15 is not null) and a.subscriber_id=b.subscriber_id and a.company_id=b.company_id  and b.is_buyer=1 and b.BATTR_VAL15 is not null UNION SELECT b.BATTR_VAL12 FROM PBEACH.PPO_MASTER_HEADER a,pbeach.psm_company_profile b WHERE a.SUBSCRIBER_ID=641 and a.creation_date between TO_DATE('2021-01-01', 'YYYY-MM-DD') and TO_DATE('2022-12-01', 'YYYY-MM-DD')  and nvl(a.is_deleted,0)!='1' and a.company_id in (SELECT COMPANY_ID FROM PBEACH.PSM_COMPANY_PROFILE WHERE SUBSCRIBER_ID=641 and is_buyer=1 and active=1 and BATTR_VAL14 is not null) and a.subscriber_id=b.subscriber_id and a.company_id=b.company_id  and b.is_buyer=1)
SELECT count(1)  as "X" FROM PBEACH.APINVOICE_HEADER a, PBEACH.PSM_COMPANY_PROFILE b WHERE a.SUBSCRIBER_ID = 641  and a.SUBSCRIBER_ID = b.subscriber_id  and a.supplier_company_id = b.company_id  and a.po_reference is null  and a.creation_date between TO_DATE('2021-01-01', 'YYYY-MM-DD') and TO_DATE('2022-12-01', 'YYYY-MM-DD')  and a.company_id in (SELECT COMPANY_ID           FROM PBEACH.PSM_COMPANY_PROFILE          WHERE SUBSCRIBER_ID = 641 and is_buyer = 1 and active = 1 and BATTR_VAL15 is not null)  and nvl(a.is_deleted, 0) != '1'
SELECT   COUNT(1) as "XA" FROM (SELECT a.AP_INVOICE_NUMBER,a.SUPPLIER_COMPANY_ID,a.VENDOR_CODE,b.company_name FROM PBEACH.APINVOICE_HEADER a, PBEACH.PSM_COMPANY_PROFILE b WHERE a.SUBSCRIBER_ID = 641  and a.SUBSCRIBER_ID = b.subscriber_id  and a.supplier_company_id = b.company_id  and a.creation_date between TO_DATE('2021-01-01', 'YYYY-MM-DD') and TO_DATE('2022-12-01', 'YYYY-MM-DD')  and a.company_id in(SELECT COMPANY_ID   FROM PBEACH.PSM_COMPANY_PROFILE  WHERE SUBSCRIBER_ID = 641    and is_buyer = 1    and active = 1    and BATTR_VAL15 is not null)  and nvl(a.is_deleted, 0) != '1'  and a.po_reference is null minus SELECT a.AP_INVOICE_NUMBER,a.SUPPLIER_COMPANY_ID,a.VENDOR_CODE,b.company_name FROM PBEACH.APINVOICE_HEADER a, PBEACH.PSM_COMPANY_PROFILE b WHERE a.SUBSCRIBER_ID = 641    and nvl(b.uses_supplier_portal_for,0) not in (2,3)  and a.SUBSCRIBER_ID = b.subscriber_id  and a.supplier_company_id = b.company_id  and a.po_reference is null  and nvl(a.is_deleted, 0) != '1'  and a.company_id in (SELECT COMPANY_ID           FROM PBEACH.PSM_COMPANY_PROFILE          WHERE SUBSCRIBER_ID = 641 and is_buyer = 1 and active = 1 and BATTR_VAL15 is not null)  and a.creation_date between TO_DATE('2021-01-01', 'YYYY-MM-DD') and TO_DATE('2022-12-01', 'YYYY-MM-DD')  and exists (SELECT 1 FROM PBEACH.SUPP_INVOICE_HEADER c WHERE c.SUBSCRIBER_ID = 641  and nvl(c.is_deleted, 0) != '1'  and a.subscriber_id = c.subscriber_id  and a.ap_invoice_number = c.ap_invoice_number) and not exists (SELECT 1   FROM PBEACH.STG_IN_DOCUDATA_INVOICE d  WHERE d.SUBSCRIBER_ID = 641    and a.subscriber_id = d.subscriber_id    and a.ap_invoice_number = d.ap_invoice_number) minus SELECT a.AP_INVOICE_NUMBER,a.SUPPLIER_COMPANY_ID,a.VENDOR_CODE,b.company_name FROM PBEACH.APINVOICE_HEADER a, PBEACH.PSM_COMPANY_PROFILE b WHERE a.SUBSCRIBER_ID = 641  and a.SUBSCRIBER_ID = b.subscriber_id  and a.supplier_company_id = b.company_id  and a.po_reference is null and a.creation_date between  TO_DATE('2021-01-01', 'YYYY-MM-DD') and TO_DATE('2022-12-01', 'YYYY-MM-DD') and a.company_id in (SELECT COMPANY_ID FROM PBEACH.PSM_COMPANY_PROFILE WHERE SUBSCRIBER_ID = 641   and is_buyer = 1 and active = 1 and BATTR_VAL15 is not null)  and nvl(a.is_deleted, 0) != '1' and exists (SELECT 1 FROM PBEACH.STG_IN_DOCUDATA_INVOICE c WHERE c.SUBSCRIBER_ID = 641  and a.subscriber_id = c.subscriber_id  and a.ap_invoice_number = c.ap_invoice_number  and (c.creation_user in (select FTP_FOR from pbeach.csv_ftp_detail where subscriber_id=641 and ftp_upload_dir like '%ereceive%'))) minus SELECT a.AP_INVOICE_NUMBER,a.SUPPLIER_COMPANY_ID,a.VENDOR_CODE,b.company_name FROM PBEACH.APINVOICE_HEADER a, PBEACH.PSM_COMPANY_PROFILE b WHERE a.SUBSCRIBER_ID = 641  and a.SUBSCRIBER_ID = b.subscriber_id  and a.supplier_company_id = b.company_id  and a.po_reference is null  and a.creation_date between TO_DATE('2021-01-01', 'YYYY-MM-DD') and TO_DATE('2022-12-01', 'YYYY-MM-DD')  and a.company_id in(SELECT COMPANY_ID   FROM PBEACH.PSM_COMPANY_PROFILE  WHERE SUBSCRIBER_ID = 641    and is_buyer = 1    and active = 1    and BATTR_VAL15 is not null)  and nvl(a.is_deleted, 0) != '1'  and not exists (SELECT 1   FROM PBEACH.SUPP_INVOICE_HEADER c  WHERE c.SUBSCRIBER_ID = 641    and a.subscriber_id = c.subscriber_id    and a.ap_invoice_number = c.ap_invoice_number)  and not exists (SELECT 1   FROM PBEACH.STG_IN_DOCUDATA_INVOICE d  WHERE d.SUBSCRIBER_ID = 641    and a.subscriber_id = d.subscriber_id    and a.ap_invoice_number = d.ap_invoice_number))
SELECT COUNT(1)  as "Y" FROM PBEACH.APINVOICE_HEADER a, PBEACH.PSM_COMPANY_PROFILE b WHERE a.SUBSCRIBER_ID = 641  and nvl(b.uses_supplier_portal_for,0) not in (2,3) and a.SUBSCRIBER_ID = b.subscriber_id  and a.supplier_company_id = b.company_id  and a.po_reference is null  and nvl(a.is_deleted, 0) != '1'  and a.company_id in (SELECT COMPANY_ID           FROM PBEACH.PSM_COMPANY_PROFILE          WHERE SUBSCRIBER_ID = 641 and is_buyer = 1 and active = 1 and BATTR_VAL15 is not null)  and a.creation_date between TO_DATE('2021-01-01', 'YYYY-MM-DD') and TO_DATE('2022-12-01', 'YYYY-MM-DD')  and exists (SELECT 1 FROM PBEACH.SUPP_INVOICE_HEADER c WHERE c.SUBSCRIBER_ID = 641  and nvl(c.is_deleted, 0) != '1'  and a.subscriber_id = c.subscriber_id  and a.ap_invoice_number = c.ap_invoice_number) and not exists (SELECT 1   FROM PBEACH.STG_IN_DOCUDATA_INVOICE d  WHERE d.SUBSCRIBER_ID = 641    and a.subscriber_id = d.subscriber_id    and a.ap_invoice_number = d.ap_invoice_number)
SELECT  count(1) as "Z" FROM PBEACH.APINVOICE_HEADER a, PBEACH.PSM_COMPANY_PROFILE b WHERE a.SUBSCRIBER_ID = 641  and a.SUBSCRIBER_ID = b.subscriber_id  and a.supplier_company_id = b.company_id  and a.po_reference is null and a.creation_date between  TO_DATE('2021-01-01', 'YYYY-MM-DD') and TO_DATE('2022-12-01', 'YYYY-MM-DD') and a.company_id in (SELECT COMPANY_ID FROM PBEACH.PSM_COMPANY_PROFILE WHERE SUBSCRIBER_ID = 641   and is_buyer = 1 and active = 1 and BATTR_VAL15 is not null)  and nvl(a.is_deleted, 0) != '1' and exists (SELECT 1 FROM PBEACH.STG_IN_DOCUDATA_INVOICE c WHERE c.SUBSCRIBER_ID = 641  and a.subscriber_id = c.subscriber_id  and a.ap_invoice_number = c.ap_invoice_number  and (c.creation_user in (select FTP_FOR from pbeach.csv_ftp_detail where subscriber_id=641 and ftp_upload_dir like '%ereceive%')))
SELECT count(1) as "AB"  FROM PBEACH.APINVOICE_HEADER a, PBEACH.PSM_COMPANY_PROFILE b WHERE a.SUBSCRIBER_ID = 641  and a.SUBSCRIBER_ID = b.subscriber_id  and a.supplier_company_id = b.company_id  and a.po_reference is null  and a.creation_date between TO_DATE('2021-01-01', 'YYYY-MM-DD') and TO_DATE('2022-12-01', 'YYYY-MM-DD')  and a.company_id in (SELECT COMPANY_ID           FROM PBEACH.PSM_COMPANY_PROFILE          WHERE SUBSCRIBER_ID = 641 and is_buyer = 1 and active = 1 and BATTR_VAL15 is not null)  and nvl(a.is_deleted, 0) != '1'  and not exists (SELECT 1 FROM PBEACH.SUPP_INVOICE_HEADER c WHERE c.SUBSCRIBER_ID = 641  and a.subscriber_id = c.subscriber_id  and a.ap_invoice_number = c.ap_invoice_number)  and not exists (SELECT 1 FROM PBEACH.STG_IN_DOCUDATA_INVOICE d WHERE d.SUBSCRIBER_ID = 641  and a.subscriber_id = d.subscriber_id  and a.ap_invoice_number = d.ap_invoice_number)
SELECT count(1)  as "AC" FROM PBEACH.APINVOICE_HEADER a, PBEACH.PSM_COMPANY_PROFILE b WHERE a.SUBSCRIBER_ID = 641  and a.SUBSCRIBER_ID = b.subscriber_id  and a.supplier_company_id = b.company_id  and a.po_reference is not null  and a.creation_date between TO_DATE('2021-01-01', 'YYYY-MM-DD') and TO_DATE('2022-12-01', 'YYYY-MM-DD')  and a.company_id in (SELECT COMPANY_ID           FROM PBEACH.PSM_COMPANY_PROFILE          WHERE SUBSCRIBER_ID = 641 and is_buyer = 1 and active = 1 and BATTR_VAL15 is not null)  and nvl(a.is_deleted, 0) != '1'
SELECT  COUNT(1) as "AC1" FROM (SELECT a.AP_INVOICE_NUMBER,a.SUPPLIER_COMPANY_ID,a.VENDOR_CODE,b.company_name FROM PBEACH.APINVOICE_HEADER a, PBEACH.PSM_COMPANY_PROFILE b WHERE a.SUBSCRIBER_ID = 641  and a.SUBSCRIBER_ID = b.subscriber_id  and a.supplier_company_id = b.company_id  and a.creation_date between TO_DATE('2021-01-01', 'YYYY-MM-DD') and TO_DATE('2022-12-01', 'YYYY-MM-DD')  and a.company_id in(SELECT COMPANY_ID   FROM PBEACH.PSM_COMPANY_PROFILE  WHERE SUBSCRIBER_ID = 641    and is_buyer = 1    and active = 1    and BATTR_VAL15 is not null)  and nvl(a.is_deleted, 0) != '1'  and a.po_reference is not null minus SELECT a.AP_INVOICE_NUMBER,a.SUPPLIER_COMPANY_ID,a.VENDOR_CODE,b.company_name FROM PBEACH.APINVOICE_HEADER a, PBEACH.PSM_COMPANY_PROFILE b WHERE a.SUBSCRIBER_ID = 641  and nvl(b.uses_supplier_portal_for,0) not in (2,3) and a.SUBSCRIBER_ID = b.subscriber_id  and a.supplier_company_id = b.company_id  and a.po_reference is not null  and nvl(a.is_deleted, 0) != '1'  and a.company_id in (SELECT COMPANY_ID           FROM PBEACH.PSM_COMPANY_PROFILE          WHERE SUBSCRIBER_ID = 641 and is_buyer = 1 and active = 1 and BATTR_VAL15 is not null)  and a.creation_date between TO_DATE('2021-01-01', 'YYYY-MM-DD') and TO_DATE('2022-12-01', 'YYYY-MM-DD')  and exists (SELECT 1 FROM PBEACH.SUPP_INVOICE_HEADER c WHERE c.SUBSCRIBER_ID = 641  and nvl(c.is_deleted, 0) != '1'  and a.subscriber_id = c.subscriber_id  and a.ap_invoice_number = c.ap_invoice_number) and not exists (SELECT 1   FROM PBEACH.STG_IN_DOCUDATA_INVOICE d  WHERE d.SUBSCRIBER_ID = 641    and a.subscriber_id = d.subscriber_id    and a.ap_invoice_number = d.ap_invoice_number) minus SELECT a.AP_INVOICE_NUMBER,a.SUPPLIER_COMPANY_ID,a.VENDOR_CODE,b.company_name FROM PBEACH.APINVOICE_HEADER a, PBEACH.PSM_COMPANY_PROFILE b WHERE a.SUBSCRIBER_ID = 641  and a.SUBSCRIBER_ID = b.subscriber_id  and a.supplier_company_id = b.company_id  and a.po_reference is not null and a.creation_date between  TO_DATE('2021-01-01', 'YYYY-MM-DD') and TO_DATE('2022-12-01', 'YYYY-MM-DD') and a.company_id in (SELECT COMPANY_ID FROM PBEACH.PSM_COMPANY_PROFILE WHERE SUBSCRIBER_ID = 641   and is_buyer = 1 and active = 1 and BATTR_VAL15 is not null)  and nvl(a.is_deleted, 0) != '1' and exists (SELECT 1 FROM PBEACH.STG_IN_DOCUDATA_INVOICE c WHERE c.SUBSCRIBER_ID = 641  and a.subscriber_id = c.subscriber_id  and a.ap_invoice_number = c.ap_invoice_number  and (c.creation_user in (select FTP_FOR from pbeach.csv_ftp_detail where subscriber_id=641 and ftp_upload_dir like '%ereceive%'))) minus SELECT a.AP_INVOICE_NUMBER,a.SUPPLIER_COMPANY_ID,a.VENDOR_CODE,b.company_name FROM PBEACH.APINVOICE_HEADER a, PBEACH.PSM_COMPANY_PROFILE b WHERE a.SUBSCRIBER_ID = 641  and a.SUBSCRIBER_ID = b.subscriber_id  and a.supplier_company_id = b.company_id  and a.po_reference is not null  and a.creation_date between TO_DATE('2021-01-01', 'YYYY-MM-DD') and TO_DATE('2022-12-01', 'YYYY-MM-DD')  and a.company_id in(SELECT COMPANY_ID   FROM PBEACH.PSM_COMPANY_PROFILE  WHERE SUBSCRIBER_ID = 641    and is_buyer = 1    and active = 1    and BATTR_VAL15 is not null)  and nvl(a.is_deleted, 0) != '1'  and not exists (SELECT 1   FROM PBEACH.SUPP_INVOICE_HEADER c  WHERE c.SUBSCRIBER_ID = 641    and a.subscriber_id = c.subscriber_id    and a.ap_invoice_number = c.ap_invoice_number)  and not exists (SELECT 1   FROM PBEACH.STG_IN_DOCUDATA_INVOICE d  WHERE d.SUBSCRIBER_ID = 641    and a.subscriber_id = d.subscriber_id    and a.ap_invoice_number = d.ap_invoice_number))
SELECT COUNT(1)  as "AD" FROM PBEACH.APINVOICE_HEADER a, PBEACH.PSM_COMPANY_PROFILE b WHERE a.SUBSCRIBER_ID = 641  and nvl(b.uses_supplier_portal_for,0) not in (2,3) and a.SUBSCRIBER_ID = b.subscriber_id  and a.supplier_company_id = b.company_id  and a.po_reference is not null  and nvl(a.is_deleted, 0) != '1'  and a.company_id in (SELECT COMPANY_ID           FROM PBEACH.PSM_COMPANY_PROFILE          WHERE SUBSCRIBER_ID = 641 and is_buyer = 1 and active = 1 and BATTR_VAL15 is not null)  and a.creation_date between TO_DATE('2021-01-01', 'YYYY-MM-DD') and TO_DATE('2022-12-01', 'YYYY-MM-DD')  and exists (SELECT 1 FROM PBEACH.SUPP_INVOICE_HEADER c WHERE c.SUBSCRIBER_ID = 641  and nvl(c.is_deleted, 0) != '1'  and a.subscriber_id = c.subscriber_id  and a.ap_invoice_number = c.ap_invoice_number) and not exists (SELECT 1   FROM PBEACH.STG_IN_DOCUDATA_INVOICE d  WHERE d.SUBSCRIBER_ID = 641    and a.subscriber_id = d.subscriber_id    and a.ap_invoice_number = d.ap_invoice_number)
SELECT count(1) as "AE" FROM PBEACH.APINVOICE_HEADER a, PBEACH.PSM_COMPANY_PROFILE b WHERE a.SUBSCRIBER_ID = 641  and a.SUBSCRIBER_ID = b.subscriber_id  and a.supplier_company_id = b.company_id  and a.po_reference is not null and a.creation_date between  TO_DATE('2021-01-01', 'YYYY-MM-DD') and TO_DATE('2022-12-01', 'YYYY-MM-DD') and a.company_id in (SELECT COMPANY_ID FROM PBEACH.PSM_COMPANY_PROFILE WHERE SUBSCRIBER_ID = 641   and is_buyer = 1 and active = 1 and BATTR_VAL15 is not null)  and nvl(a.is_deleted, 0) != '1' and exists (SELECT 1 FROM PBEACH.STG_IN_DOCUDATA_INVOICE c WHERE c.SUBSCRIBER_ID = 641  and a.subscriber_id = c.subscriber_id  and a.ap_invoice_number = c.ap_invoice_number  and (c.creation_user in (select FTP_FOR from pbeach.csv_ftp_detail where subscriber_id=641 and ftp_upload_dir like '%ereceive%')))
SELECT  count(1) as "AF"  FROM PBEACH.APINVOICE_HEADER a, PBEACH.PSM_COMPANY_PROFILE b WHERE a.SUBSCRIBER_ID = 641  and a.SUBSCRIBER_ID = b.subscriber_id  and a.supplier_company_id = b.company_id  and a.po_reference is not null  and a.creation_date between TO_DATE('2021-01-01', 'YYYY-MM-DD') and TO_DATE('2022-12-01', 'YYYY-MM-DD')  and a.company_id in (SELECT COMPANY_ID           FROM PBEACH.PSM_COMPANY_PROFILE          WHERE SUBSCRIBER_ID = 641 and is_buyer = 1 and active = 1 and BATTR_VAL15 is not null)  and nvl(a.is_deleted, 0) != '1'  and not exists (SELECT 1 FROM PBEACH.SUPP_INVOICE_HEADER c WHERE c.SUBSCRIBER_ID = 641  and a.subscriber_id = c.subscriber_id  and a.ap_invoice_number = c.ap_invoice_number)  and not exists (SELECT 1 FROM PBEACH.STG_IN_DOCUDATA_INVOICE d WHERE d.SUBSCRIBER_ID = 641  and a.subscriber_id = d.subscriber_id  and a.ap_invoice_number = d.ap_invoice_number)
SELECT substr(b.BATTR_VAL14,13,40)  as "AG" ,count(1)  as "Count" FROM PBEACH.PPO_MASTER_HEADER a,PBEACH.psm_company_profile b WHERE a.SUBSCRIBER_ID=641 and a.creation_date between TO_DATE('2021-01-01', 'YYYY-MM-DD') and TO_DATE('2022-12-01', 'YYYY-MM-DD')  and nvl(a.is_deleted,0)!='1' and a.company_id in (SELECT COMPANY_ID FROM PBEACH.PSM_COMPANY_PROFILE WHERE SUBSCRIBER_ID=641 and is_buyer=1 and active=1 and BATTR_VAL15 is not null) and a.subscriber_id=b.subscriber_id and a.company_id=b.company_id  and b.is_buyer=1 group by b.BATTR_VAL14 ORDER BY 2 desc
SELECT substr(b.BATTR_VAL12,13,40) as "AH" ,count(1) as "Count"  FROM PBEACH.PPO_MASTER_HEADER a,PBEACH.psm_company_profile b WHERE a.SUBSCRIBER_ID=641 and a.creation_date between TO_DATE('2021-01-01', 'YYYY-MM-DD') and TO_DATE('2022-12-01', 'YYYY-MM-DD')  and nvl(a.is_deleted,0)!='1' and a.company_id in (SELECT COMPANY_ID FROM PBEACH.PSM_COMPANY_PROFILE WHERE SUBSCRIBER_ID=641 and is_buyer=1 and active=1 and BATTR_VAL14 is not null) and a.subscriber_id=b.subscriber_id and a.company_id=b.company_id  and b.is_buyer=1 group by b.BATTR_VAL12 order by 2 desc
SELECT b.BRAND_NAME as "AI" ,count(1) as "Count" FROM PBEACH.PPO_MASTER_HEADER a,PBEACH.psm_company_profile b WHERE a.SUBSCRIBER_ID=641 and a.creation_date between TO_DATE('2021-01-01', 'YYYY-MM-DD') and TO_DATE('2022-12-01', 'YYYY-MM-DD')  and nvl(a.is_deleted,0)!='1' and a.subscriber_id=b.subscriber_id and a.company_id=b.company_id  and b.is_buyer=1 and b.BATTR_VAL15 is not null group by b.BRAND_NAME order by 2 desc
SELECT b.BRAND_NAME as "AJ" ,count(1) as "Count"  FROM PBEACH.APINVOICE_HEADER a,PBEACH.psm_company_profile b WHERE a.SUBSCRIBER_ID=641 and a.creation_date between TO_DATE('2021-01-01', 'YYYY-MM-DD') and TO_DATE('2022-12-01', 'YYYY-MM-DD')  and nvl(a.is_deleted,0)!='1' and a.company_id  in (SELECT COMPANY_ID FROM PBEACH.PSM_COMPANY_PROFILE WHERE SUBSCRIBER_ID=641 and is_buyer=1 and active=1 and BATTR_VAL15 is not null) and a.subscriber_id=b.subscriber_id and a.company_id=b.company_id  and b.is_buyer=1 and b.BATTR_VAL15 is not null group by b.BRAND_NAME order by 2 desc	
SELECT COUNT(0) as "AK" FROM (SELECT  distinct b.BRAND_NAME FROM PBEACH.PPO_MASTER_HEADER a,pbeach.psm_company_profile b WHERE a.SUBSCRIBER_ID=641 and a.creation_date>=TO_DATE('2021-01-01', 'YYYY-MM-DD') and nvl(a.is_deleted,0)!='1' and a.company_id in (SELECT COMPANY_ID FROM PBEACH.PSM_COMPANY_PROFILE WHERE SUBSCRIBER_ID=641 and is_buyer=1 and active=1 and BATTR_VAL14 is not null) and a.subscriber_id=b.subscriber_id and a.company_id=b.company_id  and b.is_buyer=1  union SELECT  distinct b.BRAND_NAME FROM PBEACH.APINVOICE_HEADER a,pbeach.psm_company_profile b WHERE a.SUBSCRIBER_ID=641 and a.creation_date>=TO_DATE('2021-01-01', 'YYYY-MM-DD') and nvl(a.is_deleted,0)!='1' and a.company_id  in (SELECT COMPANY_ID FROM PBEACH.PSM_COMPANY_PROFILE WHERE SUBSCRIBER_ID=641 and is_buyer=1 and active=1 and BATTR_VAL15 is not null) and a.subscriber_id=b.subscriber_id and a.company_id=b.company_id  and b.is_buyer=1 and b.BATTR_VAL15 is not null)
SELECT TO_CHAR( creation_date, 'MON-YY' ) "Exception Month",TO_CHAR( creation_date, 'YYYY-MM' ) "Year", count (distinct AP_INVOICE_NUMBER) "Count" FROM PBEACH.APINVOICE_CHG_HIST where subscriber_id=641 and VALUE_AFTER='95 (Exception)' and COMPANY_ID in (SELECT COMPANY_ID FROM pbeach.PSM_COMPANY_PROFILE where subscriber_id=641 and is_buyer=1 and BATTR_VAL15 is not null) and creation_date >TO_DATE('2021-01-01', 'YYYY-MM-DD') GROUP BY TO_CHAR( creation_date, 'MON-YY' ) ,TO_CHAR( creation_date, 'YYYY-MM' ) order by 2